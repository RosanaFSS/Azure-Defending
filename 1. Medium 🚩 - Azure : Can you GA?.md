<p align="center">May 16, 2025<br>
Hey there, fellow lifelong learner! IÂ´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and Iâ€™m genuinely excited to join you on this adventure.<br>
ItÂ´s part of my $$\textcolor{#FF69B4}{\textbf{374}}$$-day-streak in  <a href="https://tryhackme.com">TryHackMe</a>.<br><br>
<img width="300px" src="" alt="Your Image Badge"><br>
<img width="200px" src=""><br></p>

<h1 align="center">$$\textcolor{#3bd62d}{\textnormal{Azure: Can you GA?}}$$</h1>
<p align="center">Detect and investigate techniques malicious actors use to enter and control systems on a network using Defender XDR.<br>
It is classified a medium-level walkthrough, and you can join it for ðŸ†“ using your own virtual machine with openVPN or TryHackMeÂ´s AttackBox if you are subscribed. Can be accessed clicking <a href="https://tryhackme.com/room/xdrlateralmovement">here</a>.</p>

<p align="center"> <img width="1000px" src="https://github.com/user-attachments/assets/dd565cbe-3d72-4512-8f4e-71461a6bd2b5"> </p>

<br>
<br>

<h2>Task 1 . Introduction</h2>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 1.1. <em>Initiated challenge deployment</em>.<a id='1.1'></a>
>> <code><strong>No answer needed</strong></code><br>

<br>
<br>

<h2>Task 2 . Recon . Entra ID</h2>

<h3>Lay of the Land</h3>
<p>We already have a compromised Azure account potentially by means of:<br>

- Phishing attacks<br>
- Unsecured network<br>
- Weak passwords<br>
- Vulnerabilities in applications<br><br>

Log in to the tenant and do some initial recon to see what else is up.</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 2.1. <em>What is theTenant ID?</em> Hint : <em>Entra ID</em><a id='2.1'></a>
>> <code><strong>7acbf440-195e-4242-aa5c-dbac278eadf6</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/b3234a8c-f37c-4ad0-b568-c0ce20e7d8a9)

<br>

> 2.2. <em>What is the  Primary Domain?</em><a id='2.2'></a>
>> <code><strong>970781.onmicrosoft.com</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/d1572549-a91d-4d0e-8963-befab3ef24d3)

<br>

> 2.3. <em>How many App Registrations are there in this tenant?</em><a id='2.3'></a>
>> <code><strong>970781.onmicrosoft.com</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/18410057-b10d-46a6-8034-d3078a531f16)

<br>

> 2.4. <em>What is the user flag?</em><a id='2.4'></a>
>> <code><strong>THM{0f213b70-5f34-4aed-af04-53dcfb9f9a2d}</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/983257c3-dff1-493a-a305-24bd5c087c35)

<br>

<p>Clicked <code>Start download</code>.<br><br>
Clicked <code>File is ready! Clicked here to download</code>.<br><br>
Got the following ...</p>


![image](https://github.com/user-attachments/assets/7c13106a-3c55-42fe-b36c-68bfd86f193c)


<br>
<br>

<h2>Task 3 . Recon . Roles and Administrators</h2>

<p>Have you checked out administrators and their roles yet?</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 3.1. <em>Which user (UPN) has the Application Administrator role assignment?</em> Hint : <em>Assigned roles</em><a id='3.1'></a>
>> <code><strong>kennethallen@970781.onmicrosoft.com</strong></code><br>

<br>


![image](https://github.com/user-attachments/assets/6ee5b147-144c-4341-b8db-64001515f801)

<br>

![image](https://github.com/user-attachments/assets/b453e9b7-595b-492c-9ab4-876807a54274)

<br>
<br>

<h2>Task 4 . Recon . Applications</h2>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 4.1. <em>Target app: Display Name?</em> Hint : <emRoles and administrators</em><a id='4.1'></a>
>> <code><strong>kennethallen@970781.onmicrosoft.com</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/dc84d678-18ad-4d54-a198-b64a339d4296)


<br>

![image](https://github.com/user-attachments/assets/8dba9379-0c2e-4e26-984f-3d21f5fd54b5)


<br>

> 4.2. <em>Which administrator role assignment of the target app can be abused for privilege escalation?</em><a id='4.2'></a>
>> <code><strong>Privileged Role Administrator</strong></code><br>

![image](https://github.com/user-attachments/assets/6ef7d12e-20d7-4455-8fed-3339e19425d6)

<br>
<br>

<h2>Task 5 . Attack Path</h2>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 5.1. <em>Which user (display name) is the obvious candidate, i.e., target user, for a Global Administrator?</em><a id='5.1'></a>
>> <code><strong>Kenneth Allen</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/d540f47e-e632-4d29-9127-80c9d52d146d)


<br>

![image](https://github.com/user-attachments/assets/993cee9e-172a-46dc-b640-1e0f75917312)

<br>

> 5.2. <em>What's the role assignment for this user?</em><a id='5.2'></a>
>> <code><strong>Application Administrator</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/3cd811ab-9cc8-48ea-b09b-0778788f6d20)


<br>



> 5.3. <em>Which application is the obvious candidate, i.e. target app, to abuse for privilege escalation?</em> Hint: <em>SP abuse</em><a id='5.3'></a>
>> <code><strong>ITOps-App</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/ad95483b-0515-4ab6-9624-436b81ea6b82)


<br>


> 5.4. <em>What's the role assignment for this application?</em><a id='5.4'></a>
>> <code><strong>Privileged Role Administrator</strong></code><br>


![image](https://github.com/user-attachments/assets/5ac9c20f-a5da-431f-8e00-40a15223ff8d)

<br>
<br>

<h2>Task 6 . COA . Course of Action</h2>

<P>AzureHound the tenant and you shall find your path!</P>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 6.1. <em>I think I got the idea now. The question is, can I GA?</em><a id='6.1'></a>
>> <code><strong>No answer needed</strong></code><br>


<br>
<br>

<h2>Task 7 . Attack . Client Secret</h2>

<p>Time to put your scripting skills to test. Can you generate a new client secret for the target app?</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 7.1. <em>Done. What will I do with it?</em><a id='7.1'></a>
>> <code><strong>No answer needed</strong></code><br>

<br>

> 7.2. <em>There are many ways to generate a new secret. When using a PowerShell script to do it, you will need to create an object. Which object did you have to use to create a new client secret?</em> Hint : <em>System.Management.Automation.<object></em><a id='7.2'></a>
>> <code><strong>PScredential</strong></code><br>


<br>

![image](https://github.com/user-attachments/assets/295fe3fb-2efe-437d-bf3a-c5c9b9d453f7)

<br>

<br>
<br>

![image](https://github.com/user-attachments/assets/2e53e2dd-180a-4a85-9918-553b8616eec8)


